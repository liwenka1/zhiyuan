/* CodeMirror 编辑器样式 */

/* 编辑器容器 */
.cm-editor {
  height: 100%;
  font-family: var(--editor-font);
  font-size: var(--editor-font-size);
  line-height: var(--editor-line-height);
  letter-spacing: var(--editor-letter-spacing);
}

.cm-editor.cm-focused {
  outline: none;
}

/* 编辑器内容区 */
.cm-scroller {
  overflow: auto;
}

.cm-content {
  caret-color: hsl(var(--foreground));
}

/* 占位符 */
.cm-placeholder {
  color: hsl(var(--muted-foreground));
  font-style: normal;
}

/* 活动行高亮 */
.cm-activeLine {
  background-color: transparent;
}

/* 选中文本 */
.cm-selectionBackground {
  background-color: hsl(var(--selection)) !important;
}

.cm-focused .cm-selectionBackground {
  background-color: hsl(var(--selection)) !important;
}

/* 光标 */
.cm-cursor {
  border-left-color: hsl(var(--foreground));
  border-left-width: 1px;
}

/* 行号 */
.cm-lineNumbers {
  color: hsl(var(--muted-foreground));
  font-size: 12px;
}

/* 折叠标记 */
.cm-foldGutter {
  color: hsl(var(--muted-foreground));
}

/* 括号匹配 */
.cm-matchingBracket {
  background-color: hsl(var(--muted));
  outline: 1px solid hsl(var(--border));
  border-radius: 2px;
}

.cm-nonmatchingBracket {
  background-color: hsl(var(--destructive) / 0.1);
  outline: 1px solid hsl(var(--destructive));
  border-radius: 2px;
}

/* Markdown 语法增强 */

/* 标题 */
.cm-header {
  color: hsl(var(--editor-title));
}

/* 删除线 */
.cm-strikethrough {
  color: hsl(var(--editor-strikethrough));
}

/* 链接 */
.cm-link {
  color: hsl(var(--editor-link));
}

.cm-link:hover {
  opacity: 0.8;
  cursor: pointer;
}

/* URL */
.cm-url {
  color: hsl(var(--editor-url));
}

/* 引用块 */
.cm-quote {
  color: hsl(var(--editor-quote));
}

/* 列表标记 */
.cm-list {
  color: hsl(var(--editor-list));
}

/* 分割线 */
.cm-hr {
  color: hsl(var(--editor-hr));
}

/* 注释 */
.cm-comment {
  color: hsl(var(--editor-comment));
  font-style: italic;
}

/* HTML 标签 */
.cm-tag {
  color: hsl(var(--editor-tag));
}

.cm-attribute {
  color: hsl(var(--editor-attribute));
}

/* 代码块样式 */

/* 行内代码 */
.cm-monospace,
.cm-inline-code {
  font-family: var(--editor-font-mono);
  font-size: 0.9em;
  color: hsl(var(--editor-code));
  background-color: hsl(var(--editor-code-bg));
  padding: 2px 4px;
  border-radius: 3px;
  font-feature-settings:
    "liga" 1,
    "calt" 1; /* 启用连字 */
}

/* 代码块 */
.cm-codeblock {
  background-color: hsl(var(--editor-code-bg));
  border-radius: 6px;
}

/* 特殊元素 */

/* 脚注引用 */
.cm-footref {
  color: hsl(var(--editor-link));
  vertical-align: super;
  font-size: 0.8em;
}

/* 任务列表 */
.cm-task-marker {
  color: hsl(var(--editor-list-marker));
}

/* 表格 */
.cm-table {
  color: hsl(var(--foreground));
}

.cm-table-delimiter {
  color: hsl(var(--tertiary-foreground));
}

/* 性能优化 */

.cm-line {
  transition: background-color 0.15s ease;
}

.cm-editor .cm-content {
  contain: layout style;
}

/* 可访问性 */

@media (prefers-contrast: high) {
  .cm-editor {
    --editor-emphasis: var(--foreground);
    --editor-quote: var(--foreground);
  }
}
